<!DOCTYPE html>
<html>
    <head>
        <title>Sketch</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="Sketch.css">
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <!-- Optional theme -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
        <!-- Latest compiled and minified JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    </head>
    <body style="background-color: lightsalmon;">
        <div class="container">
            <div class="row">
                <canvas class="imagedisplay"></canvas>
            </div>
            
            <script type="text/javascript">
(function() {    
    const script = $(document.currentScript);
    const container = script.closest('.container');
    
    const canvas = container.find('.imagedisplay');
    
    let lines = [];
    
    const redraw = function() {
        let width = canvas.parent().width();
        let height = $(window).height() * .9;
        
        let size = Math.min(width, height);
    
        canvas.width(size);
        canvas.height(size);
        canvas.prop("width", size);
        canvas.prop("height", size);
        
        let ctx = canvas.get(0).getContext("2d");
        ctx.fillStyle = "white";
        ctx.fillRect(0, 0, size, size);
        
        ctx.strokeStyle="black";
        if (lines.length > 0) {
            lines.forEach((line)=>{
                if (line.length > 1) {
                    ctx.beginPath();
                    ctx.moveTo(size * line[1][0], size * line[1][1]);
                    
                    line.forEach((point) => {
                        ctx.lineTo(size * point[0], size * point[1]);
                        
                    });
                    ctx.stroke();
                }
            });
        }
                
    };
    
    const drawStart = function(event) {
        let point = normalize(eventLocation(event));
        
        lines.push([point]);
        console.log("start", point);
        
        redraw();
    };
    
    const drawEnd = function(event) {
        let point = normalize(eventLocation(event));
        
        console.log("end", point);
        
        if (lines.length > 0) {
            lines[lines.length - 1].push(point);
            console.log(lines[lines.length - 1]);
        }
        
        redraw();
    };
    
    const draw = function(event) {
        if (event.which === 1) {
            let point = normalize(eventLocation(event));
            if (lines.length > 0) {
                lines[lines.length - 1].push(point);
            }
            else {
                lines.push([point]);
            }
            redraw();
        }
    };
    
    function eventLocation(e) {
        e = e || window.event;

        let target = e.target || e.srcElement,
            style = target.currentStyle || window.getComputedStyle(target, null),
            borderLeftWidth = parseInt(style['borderLeftWidth'], 10),
            borderTopWidth = parseInt(style['borderTopWidth'], 10),
            rect = target.getBoundingClientRect(),
            offsetX = e.clientX - borderLeftWidth - rect.left,
            offsetY = e.clientY - borderTopWidth - rect.top;

        return [offsetX, offsetY];
    }
    
    function normalize(point) {
        let width = canvas.width();
        let height = canvas.height();
        
        return [point[0] / width, point[1] / height];
    }
    
    $(document).resize(() => {
        redraw();
    });

    canvas.mousedown(drawStart);
    canvas.mouseup(drawEnd);
    canvas.mousemove(draw);
    
    redraw();
})();


            </script>
        </div>
    </body>
</html>
